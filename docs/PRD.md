# 📄 PRD – 지능형 AI 여자친구 챗봇 서비스

## 1. 목적
사용자가 텔레그램에서 **지능형 AI 여자친구 아바타**와 자연스러운 대화를 나눌 수 있는 서비스

- **대화**: ChatGPT 기반 30대 직장인 여성 캐릭터
- **감정 인식**: 실시간 감정 분석 및 맞춤 반응
- **관계 발전**: 자동 관계 단계 추론 및 발전
- **기억 시스템**: 사용자 정보 및 대화 맥락 기억
- **향후 확장**: Stable Diffusion 기반 아바타 이미지 생성

## 2. 핵심 기능 (현재 구현완료)

### (1) 지능형 대화 시스템
- **30대 직장인 여성 캐릭터**: 운동, 자기계발, 현실적 조언
- **관계 단계별 대화**: 5단계 (처음만남→친구→썸→연인→오래된연인)
- **자연스러운 대화 발전**: AI가 관계 변화를 자동 감지하고 확인

### (2) 실시간 감정 분석
- **12가지 감정 타입**: 기쁨, 슬픔, 분노, 불안, 피곤, 설렘, 스트레스, 만족, 우울, 흥미, 놀람, 실망
- **감정 강도 측정**: 1-10 단계
- **맞춤형 반응**: 감정에 따른 적절한 공감/위로/격려/축하
- **감정 히스토리**: 과거 감정 패턴 기억 및 활용

### (3) 메모리 시스템
- **대화 기억**: 모든 대화 내용 저장 및 맥락 유지
- **사용자 정보 기억**: 이름, 취향, 습관, 중요한 정보
- **관계 히스토리**: 관계 발전 과정 추적

### (4) 관계 추론 엔진
- **자동 분석**: 5개 메시지마다 관계 상태 분석
- **패턴 인식**: 친밀도, 감정톤, 대화빈도, 주제깊이
- **자연스러운 확인**: 기계적이지 않은 관계 확인 질문

## 3. 시스템 아키텍처 (현재)

```
[User - Telegram]
        ↓
 [Telegram Bot API]
        ↓
 [Vercel Serverless Functions]
   ├── ChatGPT API (대화 + 감정분석 + 관계추론)
   └── Supabase (유저, 대화, 감정, 관계 데이터)
        ↓
 [User에게 응답: 지능형 텍스트]
```

## 4. 사용자 플로우 (현재)

### 첫 대화
1. 텔레그램 봇 시작 → 자동 사용자 등록
2. 친구 단계(기본값)로 대화 시작
3. 30대 직장인 캐릭터로 자연스러운 인사

### 대화 진행
1. 사용자 메시지 입력
2. 실시간 감정 분석 (GPT-4o-mini)
3. 감정에 맞는 맞춤 응답 생성
4. 대화 내용 및 감정 상태 저장

### 관계 발전
1. 5개 메시지마다 관계 분석 실행
2. 관계 변화 감지 시 자연스러운 확인 질문
3. 사용자 확인 시 관계 단계 업데이트
4. 새로운 관계에 맞는 대화 톤 적용

## 5. 주요 기능 요구사항 (현재 구현)

| 구분 | 요구사항 | 상태 |
|------|----------|------|
| 대화 | 30대 직장인 여성 캐릭터 기반 자연스러운 대화 | ✅ 완료 |
| 감정 인식 | 12가지 감정 실시간 분석 및 맞춤 반응 | ✅ 완료 |
| 관계 발전 | 5단계 자동 추론 및 자연스러운 발전 | ✅ 완료 |
| 메모리 | 대화 기록, 사용자 정보, 감정 히스토리 | ✅ 완료 |
| 저장 | Supabase에 모든 상호작용 데이터 저장 | ✅ 완료 |
| 인터페이스 | 텔레그램 기반 UI (간단, 접근성 높음) | ✅ 완료 |

## 6. 기술 스택 (현재)

- **Frontend/UI**: 텔레그램 봇
- **Backend**: Vercel Serverless Functions (Node.js)
- **AI API**: OpenAI GPT-4o-mini (대화 + 감정분석 + 관계추론)
- **Database**: Supabase (PostgreSQL)
- **Deployment**: Vercel + Supabase

## 7. 향후 확장 계획

### Phase 2: 아바타 이미지 시스템
- **Stable Diffusion 기반 실사 이미지 생성**
- **키워드 기반 이미지 생성**: "셀카 찍어줘", "오늘 뭐 입었어?" 등
- **사용자 선호도 반영**: 개인화된 아바타 스타일 진화
- **이미지 히스토리**: 과거 생성된 아바타들 조회 가능

### Phase 3: 고급 개인화
- **시간대별 반응**: 아침/점심/저녁 시간대별 다른 반응
- **스케줄 기반 자동 메시지**: 정해진 시간에 먼저 말 걸기
- **더 정교한 감정 패턴 분석**: 장기적 감정 변화 추적

### Phase 4: 구독 시스템
- **Free/Pro/VIP 계층**: 사용량 제한 및 고급 기능
- **결제 시스템**: Stripe 연동
- **사용량 모니터링**: 일일/월별 제한 관리

## 8. 현재 구현 상태

### ✅ 완료된 기능
- **기본 대화 시스템**: 메모리, 맥락 유지
- **캐릭터 시스템**: 30대 직장인 여성 페르소나
- **관계 추론**: 5단계 자동 분석 및 발전
- **감정 분석**: 12가지 감정 실시간 인식
- **데이터 저장**: 모든 상호작용 기록

### 🔄 다음 단계 (Phase 2)
- **아바타 이미지 생성**: Stable Diffusion 연동
- **이미지 트리거**: 키워드 기반 자동 생성
- **고급 개인화**: 시간대, 스케줄 기반 반응

## 9. 성공 지표

### 사용자 참여도
- **대화 지속률**: 7일/30일 리텐션
- **평균 대화 길이**: 메시지 수 및 시간
- **감정 반응 정확도**: 사용자 피드백 기반

### 시스템 성능
- **응답 시간**: 평균 2초 이내
- **감정 분석 정확도**: 80% 이상
- **관계 추론 정확도**: 사용자 확인률 70% 이상

### 기술 지표
- **시스템 안정성**: 99.9% 업타임
- **데이터 일관성**: 모든 상호작용 기록
- **확장성**: 동시 사용자 1000명 지원

---

**현재 구현된 시스템은 원래 계획보다 훨씬 더 지능적이고 인간적인 AI 여자친구가 되었습니다.**

감정을 이해하고, 관계를 발전시키며, 구체적인 캐릭터를 가진 진짜 사람 같은 경험을 제공하는 완전한 AI 여자친구 시스템입니다.
